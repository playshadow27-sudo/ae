<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>LifeOS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#22c55e">

<style>
:root{
--bg:#020617;
--card:#020617;
--panel:#0f172a;
--text:#e5e7eb;
--accent:#22c55e;
--danger:#ef4444;
--warn:#facc15;
}

.light{
--bg:#f1f5f9;
--panel:#ffffff;
--text:#020617;
}

*{box-sizing:border-box}

body{
margin:0;
font-family:system-ui;
background:var(--bg);
color:var(--text);
display:flex;
justify-content:center;
padding:20px;
}

.app{
width:100%;
max-width:900px;
background:var(--panel);
border-radius:16px;
padding:20px;
}

header{
display:flex;
justify-content:space-between;
align-items:center;
gap:10px;
}

h1{margin:0;font-size:24px}

button{
border:none;
border-radius:10px;
padding:8px 12px;
cursor:pointer;
background:var(--accent);
}

button.alt{background:#334155;color:white}
button.danger{background:var(--danger);color:white}

input,select,textarea{
width:100%;
padding:10px;
margin:5px 0;
border-radius:10px;
border:none;
background:var(--bg);
color:var(--text);
}

.grid{
display:grid;
grid-template-columns:1fr 1fr 1fr;
gap:8px;
}

.filters{
display:flex;
gap:6px;
margin:10px 0;
flex-wrap:wrap;
}

ul{list-style:none;padding:0;margin:0}

li{
background:var(--bg);
padding:10px;
margin-bottom:6px;
border-radius:10px;
display:flex;
gap:8px;
align-items:center;
cursor:grab;
}

li.done span{text-decoration:line-through;opacity:.6}
li.high{border-left:4px solid var(--danger)}
li.medium{border-left:4px solid var(--warn)}

li span{flex:1}

small{opacity:.7}

.stats{
display:flex;
gap:10px;
margin:10px 0;
flex-wrap:wrap;
}

.card{
background:var(--bg);
padding:10px;
border-radius:10px;
}

footer{
margin-top:15px;
display:flex;
gap:6px;
flex-wrap:wrap;
}
</style>
</head>

<body>
<div class="app">
<header>
<h1>ğŸ§  LifeOS</h1>
<div>
<button class="alt" onclick="toggleTheme()">ğŸŒ“</button>
<button class="alt" onclick="requestNotif()">ğŸ””</button>
</div>
</header>

<input id="search" placeholder="Buscar tareas...">

<div class="grid">
<input id="taskText" placeholder="Nueva tarea">
<input type="date" id="taskDate">
<select id="taskPriority">
<option value="low">Baja</option>
<option value="medium">Media</option>
<option value="high">Alta</option>
</select>
</div>

<button onclick="addTask()">AÃ±adir tarea</button>

<div class="filters">
<button class="alt" onclick="setFilter('all')">Todas</button>
<button class="alt" onclick="setFilter('todo')">Pendientes</button>
<button class="alt" onclick="setFilter('done')">Hechas</button>
</div>

<div class="stats">
<div class="card"><small id="total"></small></div>
<div class="card"><small id="pending"></small></div>
<div class="card"><small id="done"></small></div>
</div>

<ul id="list"></ul>

<h3>ğŸ“ Notas rÃ¡pidas</h3>
<textarea id="notes" rows="4"></textarea>

<footer>
<button class="alt" onclick="exportData()">Exportar</button>
<button class="alt" onclick="importData()">Importar</button>
<button class="danger" onclick="resetAll()">Reset</button>
</footer>
</div>

<script>
let tasks=JSON.parse(localStorage.getItem("tasks"))||[];
let filter="all";

const list=document.getElementById("list");
const notes=document.getElementById("notes");
notes.value=localStorage.getItem("notes")||"";

document.getElementById("search").oninput=render;
notes.oninput=()=>localStorage.setItem("notes",notes.value);

function save(){
localStorage.setItem("tasks",JSON.stringify(tasks));
}

function addTask(){
const text=taskText.value.trim();
if(!text)return;
tasks.push({
id:Date.now(),
text,
date:taskDate.value,
priority:taskPriority.value,
done:false
});
taskText.value="";
save();render();
notify("Nueva tarea aÃ±adida");
}

function render(){
list.innerHTML="";
let q=search.value.toLowerCase();

let visible=tasks.filter(t=>{
if(filter==="done"&&!t.done)return false;
if(filter==="todo"&&t.done)return false;
if(q&&!t.text.toLowerCase().includes(q))return false;
return true;
});

visible.forEach(t=>{
const li=document.createElement("li");
li.className=`${t.done?"done":""} ${t.priority}`;
li.draggable=true;

const chk=document.createElement("input");
chk.type="checkbox";
chk.checked=t.done;
chk.onchange=()=>{t.done=chk.checked;save();render()};

const span=document.createElement("span");
span.textContent=t.text+" "+(t.date?"ğŸ“… "+t.date:"");
span.onclick=()=>{
const n=prompt("Editar tarea",t.text);
if(n){t.text=n;save();render()}
};

const del=document.createElement("button");
del.textContent="X";
del.className="danger";
del.onclick=()=>{tasks=tasks.filter(x=>x.id!==t.id);save();render()};

enableDrag(li,t);
li.append(chk,span,del);
list.appendChild(li);
});

total.textContent="Total: "+tasks.length;
pending.textContent="Pendientes: "+tasks.filter(t=>!t.done).length;
done.textContent="Hechas: "+tasks.filter(t=>t.done).length;
}

function setFilter(f){filter=f;render()}

function toggleTheme(){
document.body.classList.toggle("light");
localStorage.setItem("theme",document.body.classList.contains("light")?"light":"dark");
}

if(localStorage.getItem("theme")==="light")document.body.classList.add("light");

function exportData(){
const data={tasks,notes:notes.value};
const blob=new Blob([JSON.stringify(data)],{type:"application/json"});
const a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="lifeos_backup.json";
a.click();
}

function importData(){
const i=document.createElement("input");
i.type="file";
i.accept="application/json";
i.onchange=e=>{
const r=new FileReader();
r.onload=()=>{
const d=JSON.parse(r.result);
tasks=d.tasks||[];
notes.value=d.notes||"";
save();render();
};
r.readAsText(e.target.files[0]);
};
i.click();
}

function resetAll(){
if(confirm("Â¿Seguro?")){
tasks=[];
notes.value="";
save();render();
}
}

function enableDrag(li,t){
li.ondragstart=e=>e.dataTransfer.setData("id",t.id);
li.ondragover=e=>e.preventDefault();
li.ondrop=e=>{
e.preventDefault();
const from=tasks.findIndex(x=>x.id==e.dataTransfer.getData("id"));
const to=tasks.indexOf(t);
tasks.splice(to,0,tasks.splice(from,1)[0]);
save();render();
};
}

function requestNotif(){
if("Notification"in window){
Notification.requestPermission();
}
}

function notify(msg){
if(Notification.permission==="granted"){
new Notification(msg);
}
}

document.addEventListener("keydown",e=>{
if(e.key==="Enter"&&document.activeElement===taskText)addTask();
});

render();
</script>
</body>
</html>
